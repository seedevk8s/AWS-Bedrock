<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1400 1200">
  <defs>
    <style>
      .title { font-family: Arial, sans-serif; font-size: 32px; font-weight: bold; fill: #232f3e; }
      .subtitle { font-family: Arial, sans-serif; font-size: 16px; fill: #545b64; }
      .step-title { font-family: Arial, sans-serif; font-size: 18px; fill: #ffffff; font-weight: 600; }
      .label { font-family: Arial, sans-serif; font-size: 13px; fill: #232f3e; font-weight: 600; }
      .desc { font-family: Arial, sans-serif; font-size: 11px; fill: #545b64; }
      .code { font-family: 'Courier New', monospace; font-size: 9px; fill: #232f3e; }
      .step-num { font-family: Arial, sans-serif; font-size: 24px; font-weight: bold; fill: #ffffff; }
      .data { font-family: 'Courier New', monospace; font-size: 8px; fill: #1e8900; }
      .arrow { fill: none; stroke: #ff9900; stroke-width: 3; marker-end: url(#arrowhead); }
      .flow-arrow { fill: none; stroke: #527fff; stroke-width: 2; marker-end: url(#arrowhead-blue); stroke-dasharray: 5,3; }
    </style>
    <marker id="arrowhead" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto">
      <polygon points="0 0, 10 3, 0 6" fill="#ff9900" />
    </marker>
    <marker id="arrowhead-blue" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto">
      <polygon points="0 0, 10 3, 0 6" fill="#527fff" />
    </marker>
  </defs>

  <!-- Title -->
  <text x="700" y="45" text-anchor="middle" class="title">RAG: 도서관 사서가 되는 AI</text>
  <text x="700" y="70" text-anchor="middle" class="subtitle">"서울시의 환경 정책이 궁금해" 질문이 답을 찾아가는 여정</text>

  <!-- User Question -->
  <rect x="450" y="100" width="500" height="60" fill="#fff5e6" stroke="#ff9900" stroke-width="3" rx="10"/>
  <text x="700" y="125" text-anchor="middle" class="label" style="font-size: 16px; fill: #ff9900;">👤 사용자 질문</text>
  <text x="700" y="145" text-anchor="middle" class="code" style="font-size: 12px;">"서울시의 환경 정책이 궁금해"</text>

  <!-- Step 1: PDF Loading -->
  <rect x="50" y="200" width="280" height="180" fill="#e6f2ff" stroke="#527fff" stroke-width="3" rx="10"/>
  <circle cx="80" cy="225" r="18" fill="#527fff"/>
  <text x="80" y="233" text-anchor="middle" class="step-num">1</text>
  <text x="190" y="230" text-anchor="middle" class="step-title" fill="#527fff">PDF 문서 로딩</text>

  <rect x="70" y="250" width="240" height="115" fill="#ffffff" stroke="#879596" stroke-width="1" rx="5"/>
  <text x="80" y="268" class="code">PyPDFLoader("2040_seoul_plan.pdf")</text>
  <text x="80" y="285" class="desc">📄 332페이지 PDF 문서</text>

  <rect x="80" y="300" width="220" height="55" fill="#f0f8ff" stroke="#527fff" stroke-width="1" rx="3"/>
  <text x="90" y="315" class="data">[Document(page=1, content="서울시는</text>
  <text x="90" y="328" class="data">2040년까지 탄소중립을 목표로...</text>
  <text x="90" y="341" class="data">재생에너지 확대, 친환경 교통..."),</text>
  <text x="90" y="354" class="data">Document(page=2, ...)]</text>

  <!-- Step 2: Text Splitting -->
  <rect x="370" y="200" width="280" height="180" fill="#ffe6f2" stroke="#d13212" stroke-width="3" rx="10"/>
  <circle cx="400" cy="225" r="18" fill="#d13212"/>
  <text x="400" y="233" text-anchor="middle" class="step-num">2</text>
  <text x="510" y="230" text-anchor="middle" class="step-title" fill="#d13212">텍스트 청킹</text>

  <rect x="390" y="250" width="240" height="115" fill="#ffffff" stroke="#879596" stroke-width="1" rx="5"/>
  <text x="400" y="268" class="code">RecursiveCharacterTextSplitter</text>
  <text x="400" y="283" class="code">chunk_size=1000, overlap=100</text>
  <text x="400" y="300" class="desc">📝 1000자 단위로 분할 + 100자 중복</text>

  <rect x="400" y="315" width="230" height="40" fill="#fff0f0" stroke="#d13212" stroke-width="1" rx="3"/>
  <text x="410" y="330" class="data">청크 1: "서울시는 2040년까지..."</text>
  <text x="410" y="343" class="data">청크 2: "친환경 교통 정책으로..."</text>
  <text x="410" y="356" class="data">청크 3: "환경 보호를 위한..."</text>

  <!-- Step 3: Embedding -->
  <rect x="690" y="200" width="280" height="180" fill="#e6ffe6" stroke="#1e8900" stroke-width="3" rx="10"/>
  <circle cx="720" cy="225" r="18" fill="#1e8900"/>
  <text x="720" y="233" text-anchor="middle" class="step-num">3</text>
  <text x="830" y="230" text-anchor="middle" class="step-title" fill="#1e8900">벡터 변환</text>

  <rect x="710" y="250" width="240" height="115" fill="#ffffff" stroke="#879596" stroke-width="1" rx="5"/>
  <text x="720" y="268" class="code">BedrockEmbeddings</text>
  <text x="720" y="283" class="code">titan-embed-text-v2:0</text>
  <text x="720" y="300" class="desc">🔢 텍스트 → 숫자 벡터 (1024차원)</text>

  <rect x="720" y="315" width="220" height="40" fill="#f0fff0" stroke="#1e8900" stroke-width="1" rx="3"/>
  <text x="730" y="330" class="data">[0.234, -0.891, 0.456, ..., 0.123]</text>
  <text x="730" y="343" class="data">↑ "환경 보호" 의미를 숫자로 표현</text>
  <text x="730" y="356" class="data">유사한 의미 = 가까운 벡터!</text>

  <path class="arrow" d="M 330 290 L 370 290"/>
  <path class="arrow" d="M 650 290 L 690 290"/>

  <!-- Step 4: Vector DB Storage -->
  <rect x="1010" y="200" width="340" height="180" fill="#fff5e6" stroke="#ff9900" stroke-width="3" rx="10"/>
  <circle cx="1040" cy="225" r="18" fill="#ff9900"/>
  <text x="1040" y="233" text-anchor="middle" class="step-num">4</text>
  <text x="1180" y="230" text-anchor="middle" class="step-title" fill="#ff9900">벡터 DB 저장</text>

  <rect x="1030" y="250" width="300" height="115" fill="#ffffff" stroke="#879596" stroke-width="1" rx="5"/>
  <text x="1040" y="268" class="code">Chroma.from_documents()</text>
  <text x="1040" y="285" class="desc">🗄️ 도서관 책장에 분류하여 보관</text>

  <rect x="1040" y="300" width="280" height="55" fill="#fffaf0" stroke="#ff9900" stroke-width="1" rx="3"/>
  <text x="1050" y="315" class="data">청크ID | 벡터 | 원본텍스트</text>
  <text x="1050" y="328" class="data">001 | [0.23,...] | "서울시는 2040..."</text>
  <text x="1050" y="341" class="data">002 | [0.45,...] | "친환경 교통..."</text>
  <text x="1050" y="354" class="data">... 총 1,234개 청크 저장</text>

  <path class="arrow" d="M 970 290 L 1010 290"/>

  <!-- Retrieval Process -->
  <path class="flow-arrow" d="M 700 160 L 700 420"/>

  <!-- Step 5: Question Embedding -->
  <rect x="50" y="420" width="400" height="160" fill="#e6f7ff" stroke="#527fff" stroke-width="3" rx="10"/>
  <circle cx="80" cy="445" r="18" fill="#527fff"/>
  <text x="80" y="453" text-anchor="middle" class="step-num">5</text>
  <text x="250" y="450" text-anchor="middle" class="step-title" fill="#527fff">질문을 벡터로 변환</text>

  <rect x="70" y="470" width="360" height="95" fill="#ffffff" stroke="#879596" stroke-width="1" rx="5"/>
  <text x="80" y="488" class="code">질문: "서울시의 환경 정책이 궁금해"</text>
  <text x="80" y="505" class="code">↓ 임베딩</text>
  <text x="80" y="522" class="data">질문 벡터: [0.412, -0.734, 0.891, ..., 0.234]</text>
  <text x="80" y="540" class="desc">💡 질문도 같은 방식으로 벡터화!</text>
  <text x="80" y="557" class="desc">이제 "의미적으로 가장 가까운" 문서를 찾을 수 있음</text>

  <!-- Step 6: Similarity Search -->
  <rect x="490" y="420" width="400" height="160" fill="#fff0f5" stroke="#d13212" stroke-width="3" rx="10"/>
  <circle cx="520" cy="445" r="18" fill="#d13212"/>
  <text x="520" y="453" text-anchor="middle" class="step-num">6</text>
  <text x="690" y="450" text-anchor="middle" class="step-title" fill="#d13212">유사도 검색</text>

  <rect x="510" y="470" width="360" height="95" fill="#ffffff" stroke="#879596" stroke-width="1" rx="5"/>
  <text x="520" y="488" class="code">retriever.invoke("서울시의 환경 정책...")</text>
  <text x="520" y="505" class="code">search_kwargs={"k": 3}  # 상위 3개</text>
  <text x="520" y="525" class="desc">🔍 벡터 DB에서 질문 벡터와 가장 가까운</text>
  <text x="520" y="540" class="desc">   문서 청크 3개를 찾아냄</text>
  <text x="520" y="557" class="data">유사도: 0.92 ✓  0.87 ✓  0.81 ✓</text>

  <path class="arrow" d="M 450 500 L 490 500"/>

  <!-- Step 7: Retrieved Documents -->
  <rect x="930" y="420" width="420" height="160" fill="#f0fff0" stroke="#1e8900" stroke-width="3" rx="10"/>
  <circle cx="960" cy="445" r="18" fill="#1e8900"/>
  <text x="960" y="453" text-anchor="middle" class="step-num">7</text>
  <text x="1140" y="450" text-anchor="middle" class="step-title" fill="#1e8900">관련 문서 반환</text>

  <rect x="950" y="470" width="380" height="95" fill="#ffffff" stroke="#879596" stroke-width="1" rx="5"/>
  <text x="960" y="488" class="data">📋 검색된 상위 3개 청크:</text>
  <text x="960" y="505" class="data">1. "서울시는 2040년까지 탄소중립 목표..."</text>
  <text x="960" y="520" class="data">2. "친환경 교통 정책으로 전기버스 확대..."</text>
  <text x="960" y="535" class="data">3. "재생에너지 비율을 30%까지 높이고..."</text>
  <text x="960" y="555" class="desc">✅ 이 문서들이 LLM에게 전달되어 답변 생성!</text>

  <path class="arrow" d="M 890 500 L 930 500"/>

  <!-- Generation (LLM) -->
  <rect x="450" y="620" width="500" height="140" fill="#fff5e6" stroke="#ff9900" stroke-width="3" rx="10"/>
  <text x="700" y="650" text-anchor="middle" class="label" style="font-size: 18px; fill: #ff9900;">🤖 LLM이 검색된 문서를 바탕으로 답변 생성</text>

  <rect x="470" y="665" width="460" height="80" fill="#fffaf0" stroke="#ff9900" stroke-width="2" rx="5"/>
  <text x="480" y="685" class="code" style="font-size: 10px;">"서울시는 2040년까지 탄소중립을 목표로 하고 있습니다.</text>
  <text x="480" y="700" class="code" style="font-size: 10px;">주요 환경 정책으로는:</text>
  <text x="480" y="715" class="code" style="font-size: 10px;">1. 재생에너지 비율을 30%까지 확대</text>
  <text x="480" y="730" class="code" style="font-size: 10px;">2. 전기버스 등 친환경 대중교통 확대</text>
  <text x="480" y="745" class="code" style="font-size: 10px;">3. 탄소 배출량 단계적 감축 등이 있습니다."</text>

  <path class="flow-arrow" d="M 1140 580 L 1140 640 L 950 640"/>
  <path class="flow-arrow" d="M 700 580 L 700 620"/>

  <!-- Summary -->
  <rect x="50" y="800" width="1300" height="360" fill="#f9f9f9" stroke="#232f3e" stroke-width="3" rx="10"/>
  <text x="700" y="835" text-anchor="middle" class="label" style="font-size: 22px; fill: #232f3e;">RAG 핵심 개념 정리</text>

  <!-- Key Concepts -->
  <rect x="80" y="860" width="400" height="280" fill="#e6f2ff" stroke="#527fff" stroke-width="2" rx="8"/>
  <text x="280" y="890" text-anchor="middle" class="label" style="fill: #527fff; font-size: 16px;">왜 RAG가 필요한가?</text>
  <text x="100" y="920" class="desc" style="font-size: 12px;">❌ 문제: LLM은 학습 데이터에 없는</text>
  <text x="120" y="940" class="desc" style="font-size: 12px;">최신 정보나 회사 문서를 모름</text>
  <text x="100" y="970" class="desc" style="font-size: 12px;">✅ 해결: 문서를 검색해서 LLM에게</text>
  <text x="120" y="990" class="desc" style="font-size: 12px;">참고 자료로 제공!</text>
  <text x="100" y="1020" class="desc" style="font-size: 12px;">📚 비유: 시험을 볼 때</text>
  <text x="120" y="1040" class="desc" style="font-size: 12px;">- LLM만: 암기한 내용으로 답변</text>
  <text x="120" y="1060" class="desc" style="font-size: 12px;">- RAG: 교과서를 펼쳐서 보고 답변</text>
  <text x="100" y="1090" class="desc" style="font-size: 12px;">🎯 결과: 더 정확하고 최신 정보</text>
  <text x="120" y="1110" class="desc" style="font-size: 12px;">기반의 답변 생성 가능!</text>

  <rect x="520" y="860" width="400" height="280" fill="#fff5e6" stroke="#ff9900" stroke-width="2" rx="8"/>
  <text x="720" y="890" text-anchor="middle" class="label" style="fill: #ff9900; font-size: 16px;">핵심 기술 요소</text>
  <text x="540" y="920" class="desc" style="font-size: 12px;">1️⃣ <text class="label">청킹(Chunking)</text></text>
  <text x="560" y="940" class="desc" style="font-size: 11px;">긴 문서를 검색 가능한 작은 단위로 분할</text>
  <text x="540" y="970" class="desc" style="font-size: 12px;">2️⃣ <text class="label">임베딩(Embedding)</text></text>
  <text x="560" y="990" class="desc" style="font-size: 11px;">텍스트를 의미를 담은 숫자 벡터로 변환</text>
  <text x="540" y="1020" class="desc" style="font-size: 12px;">3️⃣ <text class="label">벡터 DB</text></text>
  <text x="560" y="1040" class="desc" style="font-size: 11px;">벡터를 저장하고 빠르게 검색</text>
  <text x="540" y="1070" class="desc" style="font-size: 12px;">4️⃣ <text class="label">유사도 검색</text></text>
  <text x="560" y="1090" class="desc" style="font-size: 11px;">질문과 의미가 가장 가까운 문서 찾기</text>
  <text x="540" y="1120" class="desc" style="font-size: 12px;">5️⃣ <text class="label">컨텍스트 주입</text></text>
  <text x="560" y="1140" class="desc" style="font-size: 11px;">검색 결과를 LLM에게 제공하여 답변 생성</text>

  <rect x="960" y="860" width="340" height="280" fill="#e6ffe6" stroke="#1e8900" stroke-width="2" rx="8"/>
  <text x="1130" y="890" text-anchor="middle" class="label" style="fill: #1e8900; font-size: 16px;">실제 활용 예시</text>
  <text x="980" y="920" class="desc" style="font-size: 12px;">🏢 <text class="label">기업 문서 검색</text></text>
  <text x="1000" y="940" class="desc" style="font-size: 11px;">내부 매뉴얼, 정책 문서</text>
  <text x="980" y="970" class="desc" style="font-size: 12px;">📰 <text class="label">뉴스/리포트 분석</text></text>
  <text x="1000" y="990" class="desc" style="font-size: 11px;">최신 뉴스, 연구 논문</text>
  <text x="980" y="1020" class="desc" style="font-size: 12px;">💬 <text class="label">고객 지원 챗봇</text></text>
  <text x="1000" y="1040" class="desc" style="font-size: 11px;">FAQ, 제품 설명서</text>
  <text x="980" y="1070" class="desc" style="font-size: 12px;">⚖️ <text class="label">법률 자문</text></text>
  <text x="1000" y="1090" class="desc" style="font-size: 11px;">판례, 법률 조문</text>
  <text x="980" y="1120" class="desc" style="font-size: 12px;">🏥 <text class="label">의료 정보</text></text>
  <text x="1000" y="1140" class="desc" style="font-size: 11px;">논문, 진료 가이드라인</text>
</svg>
